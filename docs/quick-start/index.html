<!DOCTYPE html>
<html lang="cn">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Quick Start"><meta property="og:title" content="" />
<meta property="og:description" content="快速开始 假设我们有一个语言Simple，这个语言只能定义变量，定义变量的规则是先写一个var关键字，然后空格接一个标识符，标识符只能有字母和数字组成，然后可以有一个初始值number，初始值必须是个整数。无需声明类型。
&#39;var&#39; ID &#39;=&#39; number 现在我们利用Foundation框架，为这个语言编写一个简单的词法分析器和语法分析器。 Let&rsquo;s Start!
新建一个项目 下面详细阐述如何将框架导入你的Java项目之中，如果你之前有过使用Java第三方库的经历，你可以选择跳过这一章节，从下载安装页面直接下载jar包自行导入。
 Yan-Foundation Jar导入教程 展开  推荐使用Intellij Idea作为开发环境，当然你也可以使用Eclipse，本文以Idea为例。
 打开Idea，新建一个Java项目，选择Java SDK。  Foundation框架使用Java11构建，因此你需要使用Java11或更高版本。当前Oracle发布的最新版本是Java13，如果你的版本低于11，你可以前往Oracle官网下载最新版本的Java SDK。  一直点Next直到创建好项目，你将会得到类似下图的项目结构。如果你勾选了Create Project from Template，你将会和我一样获得一个Main文件。如果没有，你可以自己创建一个。
导入Foundation依赖   对Java不熟悉的同学，可以把这一步想成C&#43;&#43;/C的include，或者是Python的pip install。
 在这里，我们使用jar包(点击下载)的形式导入foundation框架。依照下图步骤操作，在第四步后会弹出一个文件选择界面，选择刚刚下载的jar包，然后一直点击OK即可。
   最开始的开始 创建一个可以执行的解释器还有命令行程序需要多少行代码？100？1000？  使用foundation框架，你只需要在你的main函数中添加如下两行代码即可。
package yan.demo.simple; import yan.foundation.Language; import yan.foundation.Launcher; public class Main { public static void main(String[] args) { Language language = new Language(); Launcher.launch(language, args); } } 解释器 如果你使用Idea，点击main函数旁边的绿色三角形即可启动程序。启动之后，你将看到类似下图所示的一个交互式解释器。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://yan-lang.github.io/docs/quick-start/" />

<title>Quick Start | Yan</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">
<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>


<link rel="stylesheet" href="/book.min.905d60b54d0f3f48fa8f7381e59247991913eee3bc984871847651849e1d1f70.css" integrity="sha256-kF1gtU0PP0j6j3OB5ZJHmRkT7uO8mEhxhHZRhJ4dH3A=">


<script defer src="/cn.search.min.f60560136dcbfbaa6dba61b9306f8c2c99ccefd4d475b8fd8f11673faef23f49.js" integrity="sha256-9gVgE23L&#43;6ptumG5MG&#43;MLJnM79TUdbj9jxFnP67yP0k="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><img src="/logo.png" alt="Logo" /><span>Yan</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





  <ul>
<li>
<ul>
<li><a href="/docs/about/">关于&quot;言&rdquo;</a></li>
<li><a href="/posts/">博客</a></li>
<li><a href="/docs/download/">下载安装</a></li>
<li><a href="/docs/quick-start/"class=active>快速开始</a></li>
<li><a href="/docs/doc/">文档</a></li>
<li><a href="/docs/source/">源代码</a></li>
<li><a href="/docs/contributing/">贡献</a></li>
</ul>
</li>
<li>
<p><strong>实验</strong></p>
<ul>
<li><a href="/docs/shortcodes/buttons/">YCC框架</a></li>
</ul>
</li>
<li>
<p><strong>项目</strong></p>
<ul>
<li><a href="https://github.com/yan-lang/yan/tree/master/foundation">Yan Foundation</a></li>
<li><a href="https://github.com/yan-lang/yan/tree/master/yan-lang">Yan Lang</a></li>
<li><a href="https://github.com/yan-lang/token-util">Token Util</a></li>
</ul>
</li>
</ul>





</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Quick Start</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#快速开始">快速开始</a>
      <ul>
        <li><a href="#新建一个项目">新建一个项目</a></li>
        <li><a href="#最开始的开始">最开始的开始</a>
          <ul>
            <li><a href="#解释器">解释器</a></li>
            <li><a href="#命令行程序">命令行程序</a></li>
            <li><a href="#一些概念">一些概念</a></li>
          </ul>
        </li>
        <li><a href="#词法分析器">词法分析器</a></li>
        <li><a href="#语法分析器">语法分析器</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
<article class="markdown"><h1 id="快速开始">快速开始</h1>
<p>假设我们有一个语言<strong>Simple</strong>，这个语言只能定义变量，定义变量的规则是先写一个<code>var</code>关键字，然后空格接一个<code>标识符</code>，标识符只能有字母和数字组成，然后可以有一个初始值<code>number</code>，初始值必须是个整数。无需声明类型。</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&#39;var&#39; ID &#39;=&#39; number
</code></pre></div><p>现在我们利用Foundation框架，为这个语言编写一个简单的词法分析器和语法分析器。 Let&rsquo;s Start!</p>
<h2 id="新建一个项目">新建一个项目</h2>
<p>下面详细阐述如何将框架导入你的Java项目之中，如果你之前有过使用Java第三方库的经历，你可以选择跳过这一章节，从<a href="/docs/download/">下载安装</a>页面直接下载jar包自行导入。</p>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Yan-Foundation Jar导入教程</span>
      <span>展开</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <p>推荐使用Intellij Idea作为开发环境，当然你也可以使用Eclipse，本文以Idea为例。</p>
<ol>
<li><strong>打开Idea，新建一个Java项目，选择Java SDK。</strong></li>
</ol>
<blockquote class="book-hint info">
  Foundation框架使用Java11构建，因此你需要使用Java11或更高版本。当前Oracle发布的最新版本是Java13，如果你的版本低于11，你可以前往Oracle官网下载最新版本的Java SDK。
</blockquote>
<p><img src="/img/quick-start/new-project.png" alt="create new idea project"></p>
<p>一直点<code>Next</code>直到创建好项目，你将会得到类似下图的项目结构。如果你勾选了<code>Create Project from Template</code>，你将会和我一样获得一个Main文件。如果没有，你可以自己创建一个。</p>
<p><img src="/img/quick-start/idea-project-structure.png" alt="basic idea project structure"></p>
<ol start="2">
<li><strong>导入Foundation依赖</strong></li>
</ol>
<blockquote>
<p>对Java不熟悉的同学，可以把这一步想成C++/C的<code>include</code>，或者是Python的<code>pip install</code>。</p>
</blockquote>
<p>在这里，我们使用jar包(<a href="">点击下载</a>)的形式导入foundation框架。依照下图步骤操作，在第四步后会弹出一个文件选择界面，选择刚刚下载的jar包，然后一直点击<code>OK</code>即可。</p>
<p><img src="/img/quick-start/import.png" alt="import jar dependency"></p>

    </div>
  </label>
</div>

<h2 id="最开始的开始">最开始的开始</h2>
<blockquote class="book-hint info">
  创建一个可以执行的解释器还有命令行程序需要多少行代码？100？1000？
</blockquote>

<p>使用foundation框架，你只需要在你的main函数中添加如下两行代码即可。</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="font-weight:bold">package</span> <span style="color:#555">yan.demo.simple</span><span style="font-weight:bold">;</span>

<span style="font-weight:bold">import</span> <span style="color:#555">yan.foundation.Language</span><span style="font-weight:bold">;</span>
<span style="font-weight:bold">import</span> <span style="color:#555">yan.foundation.Launcher</span><span style="font-weight:bold">;</span>

<span style="font-weight:bold">public</span> <span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Main</span> <span style="font-weight:bold">{</span>

    <span style="font-weight:bold">public</span> <span style="font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="font-weight:bold">(</span>String<span style="font-weight:bold">[]</span> args<span style="font-weight:bold">)</span> <span style="font-weight:bold">{</span>
        Language language <span style="font-weight:bold">=</span> <span style="font-weight:bold">new</span> Language<span style="font-weight:bold">();</span>
        Launcher<span style="font-weight:bold">.</span><span style="color:#008080">launch</span><span style="font-weight:bold">(</span>language<span style="font-weight:bold">,</span> args<span style="font-weight:bold">);</span>
    <span style="font-weight:bold">}</span>
<span style="font-weight:bold">}</span>
</code></pre></div><h3 id="解释器">解释器</h3>
<p>如果你使用<code>Idea</code>，点击main函数旁边的绿色三角形即可启动程序。启动之后，你将看到类似下图所示的一个交互式解释器。</p>
<p><img src="/img/quick-start/repl-demo.gif" alt="repl demo"></p>
<p>你可以在这里输入代码，或者一些内建指令。内建指令以冒号<code>:</code>开头，对于其他不以冒号开头的字符串，解释器将其视为<code>代码</code>，当你按下回车时，解释器为调用你编写的Phase(如词法分析器)等对代码进行分析，并把结果显示出来（图中展示的例子没有显示任何东西，因为你还没有为你的语言编写Phase！）。</p>
<blockquote class="book-hint info">
  <ol>
<li>最常用的内建指令是<code>:help</code>，你可以通过这个指令获取解释器支持哪些内建指令。</li>
<li>怎么添加Phase(词法分析器/语法分析器)？后面会讲。</li>
</ol>
</blockquote>

<h3 id="命令行程序">命令行程序</h3>
<p>事实上，在获得一个交互式解释器的同时，你还获得了一个Simple语言的命令行程序，你可以像下面这样在命令行中指定输入文件，输出文件，其他参数等，就像使用Python或者GCC一样。</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">// 你需要将程序打包成simple.jar
java -jar simple.jar input.simple -o out.txt
</code></pre></div><p>如果你输入<code>java -jar simple.jar --help</code>，你还会看到如下的帮助信息。</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">Usage: &lt;main class&gt; <span style="font-weight:bold">[</span>-hV<span style="font-weight:bold">]</span> <span style="font-weight:bold">[</span>-o<span style="font-weight:bold">=</span>&lt;outputFile&gt;<span style="font-weight:bold">]</span> <span style="font-weight:bold">[</span>-t<span style="font-weight:bold">=</span>&lt;target&gt;<span style="font-weight:bold">]</span> &lt;inputFile&gt;
      &lt;inputFile&gt;         The file to be processed.
  -h, --help              Show this <span style="color:#999">help</span> message and exit.
  -o, --output<span style="font-weight:bold">=</span>&lt;outputFile&gt;
                          Output file <span style="font-weight:bold">for</span> result
  -t, --target<span style="font-weight:bold">=</span>&lt;target&gt;   The stage you want to compile to. Valid values: .
                            Default: null
  -V, --version           Print version information and exit.
</code></pre></div><blockquote class="book-hint info">
  <p>细心的同学可能会注意到, 这里有一个参数target, 这个参数实际上指定的是你编写的编译器要编译到哪个阶段。因为你还没有为编译器编写任何一个阶段，所以现在它的Valid values和default都是空或者null。</p>
<p>当你编写好词法分析器和语法分析器时，valid value就会变成类似<code>lex, parse</code>之类的，到时候你就可以使用命令行参数进行指定，获取中间结果。</p>
<p>类似的，使用我们的框架，这些功能都是免费送的，你几乎不需要编写任何代码。</p>

</blockquote>

<h3 id="一些概念">一些概念</h3>
<p>在正式开始编写词法分析器之前，我们先了解一个概念<code>Phase</code>。</p>
<p><strong>Phase</strong></p>
<p>相信在编译原理的前几节课，老师们都会跟你们讲编译器的组成，通常来说，编译器由5或6个阶段构成，例如词法分析器，语法分析器，语义分析器，中间代码生成，代码优化和目标代码生成。</p>
<p>事实上，当我们把这些过程抽象出来，我们会发现，<strong>每个过程其实就是将程序的一种表示转换成另一种</strong>。在我们的foundation框架中，这个过程被定义为一个<code>Phase</code>。例如，词法分析器<code>Phase&lt;String, List&lt;Token&gt;&gt;</code>就是从string到一个token列表，语法分析器<code>Phase&lt;List&lt;Token&gt;, Tree.TopLevel&gt;</code>就是从Token列表转换成一棵抽象语法树。</p>
<p>在我们的框架中，创建Phase和添加Phase都十分简单，请接着往下看。</p>
<h2 id="词法分析器">词法分析器</h2>
<p>现在我们来为了我们的Simple语言编写一个词法分析器（Lexer Phase）。</p>
<ol>
<li><strong>首先新建一个文件<code>Lexer.java</code>，修改里面的内容成如下所示</strong>。
<ul>
<li>
<p><a href="">AbstractLexer</a>是foundation框架中提供的一个Lexer模版，该类继承自<code>Phase&lt;String, List&lt;Token&gt;&gt;</code>，并提供许多你在词法分析中可以使用的实用函数（Helper Function）。</p>
</li>
<li>
<p><a href="">Token</a>是foundation框架中定义的单词(Token)的数据结构。</p>
</li>
</ul>
</li>
</ol>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="font-weight:bold">import</span> <span style="color:#555">yan.foundation.compiler.frontend.lex.AbstractLexer</span><span style="font-weight:bold">;</span>
<span style="font-weight:bold">import</span> <span style="color:#555">yan.foundation.compiler.frontend.lex.Token</span><span style="font-weight:bold">;</span>

<span style="font-weight:bold">public</span> <span style="font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Lexer</span> <span style="font-weight:bold">extends</span> AbstractLexer <span style="font-weight:bold">{</span>
    @Override
    <span style="font-weight:bold">public</span> Token <span style="color:#900;font-weight:bold">nextToken</span><span style="font-weight:bold">()</span> <span style="font-weight:bold">{</span>
        <span style="font-weight:bold">return</span> <span style="font-weight:bold">null</span><span style="font-weight:bold">;</span>
    <span style="font-weight:bold">}</span>
<span style="font-weight:bold">}</span>
</code></pre></div><ol start="2">
<li>
<p><strong>在<code>Main.java</code>中添加我们刚刚编写的词法分析器</strong>。</p>
<ul>
<li>向你的语言中添加一个词法分析器特别简单，只需要调用<code>语言对象.addPhase()</code>即可。</li>
<li><code>addPhase()</code>包含两个参数：
<ul>
<li>第一个参数接受一个<code>Phase&lt;In, Out&gt;</code>即一个编译阶段。（这就是为什么AbstractLexer需要继承自<code>Phase&lt;String, List&lt;Token&gt;&gt;</code>。</li>
<li>第二个参数是一个字符串<code>target</code>，这个字符串会作为命令行选项<code>--target</code>的可选值。</li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="font-weight:bold">public</span> <span style="font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="font-weight:bold">(</span>String<span style="font-weight:bold">[]</span> args<span style="font-weight:bold">)</span> <span style="font-weight:bold">throws</span> Exception <span style="font-weight:bold">{</span> <span style="color:#998;font-style:italic">// addPhase可能会抛出异常
</span><span style="color:#998;font-style:italic"></span>    Language language <span style="font-weight:bold">=</span> <span style="font-weight:bold">new</span> Language<span style="font-weight:bold">();</span>
    language<span style="font-weight:bold">.</span><span style="color:#008080">addPhase</span><span style="font-weight:bold">(</span><span style="font-weight:bold">new</span> Lexer<span style="font-weight:bold">(),</span> <span style="color:#b84">&#34;lex&#34;</span><span style="font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 新增
</span><span style="color:#998;font-style:italic"></span>    Launcher<span style="font-weight:bold">.</span><span style="color:#008080">launch</span><span style="font-weight:bold">(</span>language<span style="font-weight:bold">,</span> args<span style="font-weight:bold">);</span>
<span style="font-weight:bold">}</span>
</code></pre></div><p>虽然我们还没有真正的编写分析逻辑，不过没关系，现在你可以点击三角箭头，运行看看吧。</p>
<h2 id="语法分析器">语法分析器</h2>
</article>
 

      <footer class="book-footer">
        
  <div class="flex justify-between">

  


  

  



<div class="book-languages">

  <ul>
    <li class="flex">
      <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
      简体中文
    </li> 
  </ul>

  <ul class="book-languages-list">
    
    <li class="active">
      <a href="https://yan-lang.github.io/" class="flex">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        简体中文
      </a>
    </li>
    
    <li class="">
      <a href="https://yan-lang.github.io/en/" class="flex">
        <img src="/svg/translate.svg" class="book-icon" alt="Languages" />
        English
      </a>
    </li>
    
  </ul>

</div>






</div>

 
        
  
  <div class="book-comments">

</div>
  
 
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#快速开始">快速开始</a>
      <ul>
        <li><a href="#新建一个项目">新建一个项目</a></li>
        <li><a href="#最开始的开始">最开始的开始</a>
          <ul>
            <li><a href="#解释器">解释器</a></li>
            <li><a href="#命令行程序">命令行程序</a></li>
            <li><a href="#一些概念">一些概念</a></li>
          </ul>
        </li>
        <li><a href="#词法分析器">词法分析器</a></li>
        <li><a href="#语法分析器">语法分析器</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












